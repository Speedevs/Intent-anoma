<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Anoma — Intent Demo</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/feather-icons"></script>
  <style>
    :root {
      --indigo: #4f46e5;
      --purple: #7c3aed;
      --muted: #6b7280;
    }
    body {
      margin: 0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto;
      background: #fff;
      color: #000;
    }
    .ambient {
      position: fixed;
      inset: -40vmax;
      width: 80vmax;
      height: 80vmax;
      background: radial-gradient(40% 40% at 30% 30%, rgba(79,70,229,0.2), transparent),
                  radial-gradient(40% 40% at 70% 60%, rgba(124,58,237,0.15), transparent);
      filter: blur(40px);
      z-index: 0;
      pointer-events: none;
    }
    .screen { display: none; }
    .screen.active { display: block; }
    .landing-line {
      font-size: clamp(1.4rem, 4vw, 2.2rem);
      font-weight: 700;
      line-height: 1.3;
    }
    .cta-btn, .primary-btn {
      border: none;
      border-radius: 12px;
      background: linear-gradient(90deg, var(--indigo), var(--purple));
      color: #fff;
      font-weight: 600;
      padding: 0.8rem 1.2rem;
      cursor: pointer;
    }
    .secondary-btn {
      border: 1px solid #ddd;
      border-radius: 12px;
      padding: 0.7rem 1rem;
      background: #fff;
      cursor: pointer;
    }
    .card {
      background: #fff;
      border: 1px solid #e5e7eb;
      border-radius: 14px;
      padding: clamp(14px, 3vw, 20px);
      margin-bottom: 1rem;
    }
    .card-title { font-weight: 600; margin-bottom: 0.5rem; }
    .input {
      width: 100%;
      border: 1px solid #ddd;
      border-radius: 10px;
      padding: 0.6rem 0.8rem;
    }
    .divider { height: 1px; background: #eee; margin: 1rem 0; }
    .hint.ok { color: #16a34a; }
    .hint.warn { color: #dc2626; }
    .steps { list-style: none; padding: 0; margin: 0; }
    .step { display: flex; align-items: center; gap: 8px; margin: 0.4rem 0; }
    .step .dot {
      width: 10px; height: 10px; border-radius: 50%; border: 2px solid var(--indigo);
    }
    .step.current .dot { background: #c7d2fe; }
    .step.done .dot { background: var(--indigo); }
    .wallet-btn span { color: #fff; }
    .wallet-btn svg { stroke: #fff; }
    .mage-container { display: flex; justify-content: center; padding: 1rem; }
    .mage-image { max-width: clamp(120px, 40vw, 200px); height: auto; }
    .nav-link { font-weight: 500; cursor: pointer; }
    /* Toast */
    .toast {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      background: #111827;
      color: #fff;
      padding: 10px 16px;
      border-radius: 10px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
      opacity: 0;
      pointer-events: none;
      transition: opacity .3s ease;
      z-index: 50;
    }
    .toast.show { opacity: 1; }
  </style>
</head>

<body class="min-h-screen flex flex-col text-black">
  <div class="ambient"></div>

  <!-- Header -->
  <header class="w-full border-b border-gray-200 backdrop-blur-sm bg-white/70 fixed top-0 z-40">
    <div class="max-w-6xl mx-auto px-4 py-3 flex items-center justify-between">
      <div class="flex items-center gap-3">
        <img src="https://speedevs.github.io/Anoma-ID/anoma.png" alt="Anoma" class="w-8 h-8 sm:w-10 sm:h-10" />
        <h1 class="text-lg sm:text-xl font-semibold">
          <span class="text-red-500">Anoma</span>
        </h1>
      </div>
      <nav class="hidden md:flex gap-4 items-center">
        <button data-next="screen-landing" class="nav-link">Home</button>
        <button data-next="screen-wrap" class="nav-link">Wrap</button>
        <button data-next="screen-declare" class="nav-link">Declare</button>
        <button data-next="screen-portfolio" class="nav-link">Wallet</button>
        <button id="connectBtn" class="wallet-btn flex items-center gap-2 px-4 py-2 rounded-full bg-indigo-600 hover:bg-indigo-700 text-white">
          <i data-feather="user" class="w-5 h-5"></i> Connect
        </button>
      </nav>
      <button id="hamburgerBtn" class="md:hidden">
        <i data-feather="menu" class="w-6 h-6"></i>
      </button>
    </div>
    <div id="mobileNav" class="hidden md:hidden flex-col gap-2 px-4 pb-3 bg-white border-t">
      <button data-next="screen-landing" class="nav-link">Home</button>
      <button data-next="screen-wrap" class="nav-link">Wrap</button>
      <button data-next="screen-declare" class="nav-link">Declare</button>
      <button data-next="screen-portfolio" class="nav-link">Wallet</button>
    </div>
  </header>

  <div class="h-16"></div>

  <!-- Main -->
  <main class="flex-1 w-full">
    <div class="max-w-6xl mx-auto px-4 py-10">
      <!-- Landing -->
      <section id="screen-landing" class="screen active">
        <div class="text-center max-w-2xl mx-auto">
          <h2 class="landing-line">
            Wrap your assets. Declare your intent. Pay with stability.
          </h2>
          <div class="flex justify-center">
            <button class="cta-btn w-full sm:w-auto" data-next="screen-wrap">Start an Intent</button>
          </div>
        </div>
      </section>

      <!-- Wrap -->
      <section id="screen-wrap" class="screen">
        <div class="card max-w-xl mx-auto text-center">
          <h3 class="card-title">Asset Wrapping</h3>
          <label class="input-label">BTC</label>
          <input id="btcInput" type="number" class="input mb-2" placeholder="0.0" />
          <p id="btcUsd" class="muted text-sm mb-3">$0.00</p>

          <label class="input-label">ETH</label>
          <input id="ethInput" type="number" class="input mb-2" placeholder="0.0" />
          <p id="ethUsd" class="muted text-sm mb-3">$0.00</p>

          <label class="input-label">USDC</label>
          <input id="usdcInput" type="number" class="input mb-2" placeholder="0.0" />
          <p id="usdcUsd" class="muted text-sm mb-3">$0.00</p>

          <div class="divider"></div>
          <p>Total: <strong id="totalUsd">$0.00</strong></p>

          <div class="flex justify-center mt-4">
            <button id="btnCreateSIT" class="primary-btn">Create SIT</button>
          </div>
        </div>
      </section>

      <!-- Declare -->
      <section id="screen-declare" class="screen">
        <div class="card max-w-xl mx-auto text-center">
          <h3 class="card-title">Declare Payment Intent</h3>
          <input id="recipientInput" type="text" class="input mb-3" placeholder="Recipient username" />
          <button id="btnCastIntent" class="primary-btn w-full">Cast Intent</button>
        </div>
      </section>

      <!-- Tracking -->
      <section id="screen-tracking" class="screen">
        <div class="card max-w-xl mx-auto text-center">
          <h3 class="card-title">Intent Status</h3>
          <ol class="steps text-left">
            <li id="step1" class="step current"><span class="dot"></span> Intent broadcast</li>
            <li id="step2" class="step"><span class="dot"></span> Network coordination</li>
            <li id="step3" class="step"><span class="dot"></span> Settlement complete</li>
          </ol>
          <div id="settleMsg" class="mt-3"></div>
          <button id="btnToPortfolio" class="secondary-btn w-full mt-3 hidden">Go to Portfolio</button>
        </div>
      </section>

      <!-- Portfolio -->
      <section id="screen-portfolio" class="screen">
        <div class="card max-w-xl mx-auto text-center">
          <h3 class="card-title">Portfolio</h3>
          <p>SIT Balance: <span id="sitBalance">0</span></p>
          <button id="btnUnwrap" class="secondary-btn w-full mt-3">Unwrap SIT</button>
        </div>
      </section>
    </div>
  </main>

  <!-- Bottom mage -->
  <div class="mage-container">
    <img class="mage-image"
      src="https://raw.githubusercontent.com/Speedevs/Anoma-game/c9d80be6c74d5b5dffeb79307f63b670d0cd41fa/mage.png"
      alt="Mage" />
  </div>

  <!-- Mobile sticky nav -->
  <nav class="md:hidden fixed bottom-0 inset-x-0 bg-white border-t z-40 flex justify-around py-2">
    <button data-next="screen-landing"><i data-feather="home"></i></button>
    <button data-next="screen-wrap"><i data-feather="layers"></i></button>
    <button data-next="screen-declare"><i data-feather="send"></i></button>
    <button data-next="screen-portfolio"><i data-feather="briefcase"></i></button>
  </nav>

  <!-- Toast -->
  <div id="toast" class="toast"></div>

  <script>
    feather.replace();
    document.querySelectorAll('.wallet-btn svg').forEach(svg => svg.setAttribute('stroke', '#fff'));

    // Navigation
    function show(id) {
      document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
      document.getElementById(id).classList.add('active');
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }
    document.querySelectorAll('[data-next]').forEach(btn => {
      btn.addEventListener('click', () => show(btn.dataset.next));
    });
    document.getElementById('hamburgerBtn').addEventListener('click', () => {
      document.getElementById('mobileNav').classList.toggle('hidden');
    });

    // Elements
    const els = {
      btc: document.getElementById('btcInput'),
      eth: document.getElementById('ethInput'),
      usdc: document.getElementById('usdcInput'),
      btcUsd: document.getElementById('btcUsd'),
      ethUsd: document.getElementById('ethUsd'),
      usdcUsd: document.getElementById('usdcUsd'),
      totalUsd: document.getElementById('totalUsd'),
      create: document.getElementById('btnCreateSIT'),
      cast: document.getElementById('btnCastIntent'),
      unwrap: document.getElementById('btnUnwrap'),
      sitBal: document.getElementById('sitBalance'),
      recipient: document.getElementById('recipientInput'),
      toast: document.getElementById('toast'),
      step1: document.getElementById('step1'),
      step2: document.getElementById('step2'),
      step3: document.getElementById('step3'),
      settleMsg: document.getElementById('settleMsg'),
      toPortfolio: document.getElementById('btnToPortfolio')
    };

    // Mock rates
    const rates = { BTC: 60000, ETH: 2500, USDC: 1 };
    let state = { sit: 0, total: 0 };

    function fmtUSD(n) {
      return `$${n.toLocaleString(undefined,{minimumFractionDigits:2,maximumFractionDigits:2})}`;
    }

    function recalc() {
      const btc = parseFloat(els.btc.value || 0);
      const eth = parseFloat(els.eth.value || 0);
      const usdc = parseFloat(els.usdc.value || 0);
      const b = btc * rates.BTC;
      const e = eth * rates.ETH;
      const u = usdc * rates.USDC;
      const t = b + e + u;
      els.btcUsd.textContent = fmtUSD(b);
      els.ethUsd.textContent = fmtUSD(e);
      els.usdcUsd.textContent = fmtUSD(u);
      els.totalUsd.textContent = fmtUSD(t);
      state.total = t;
    }
    ['input','change'].forEach(evt=>{
      els.btc.addEventListener(evt, recalc);
      els.eth.addEventListener(evt, recalc);
      els.usdc.addEventListener(evt, recalc);
    });
    recalc();

    // Toast
    function toast(msg) {
      els.toast.textContent = msg;
      els.toast.classList.add('show');
      setTimeout(()=>els.toast.classList.remove('show'), 2000);
    }

    // Create SIT
    els.create.addEventListener('click', () => {
      state.sit += 1;
      els.sitBal.textContent = state.sit;
      toast(`✅ Successfully locked and minted ${fmtUSD(state.total)} of assets`);
      show('screen-declare');
    });

    // Cast Intent
    els.cast.addEventListener('click', () => {
      if (state.sit <= 0) return toast("❌ No SIT available");
      const user = els.recipient.value || "anon";
      state.sit -= 1;
      els.sitBal.textContent = state.sit;
      toast(`✅ Successfully paid Recipient as "${user}" 36 $XAN`);
      show('screen-tracking');
      els.settleMsg.textContent = `Paid ${user} 36 $XAN`;
      els.toPortfolio.classList.remove('hidden');
    });

    // Unwrap
    els.unwrap.addEventListener('click', () => {
      toast("✅ Successfully unwrapped");
    });

    // Go to portfolio
    els.toPortfolio.addEventListener('click', ()=>show('screen-portfolio'));
  </script>
</body>
</html>